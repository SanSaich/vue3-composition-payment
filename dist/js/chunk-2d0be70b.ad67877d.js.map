{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/login-form.js","webpack:///./src/views/Auth.vue?59b5"],"names":["for","class","onSubmit","eError","type","id","email","eBlur","pError","password","pBlur","disabled","isSubmitting","isTooManyAttempts","useLoginForm","store","useStore","router","useRouter","useForm","handleSubmit","submitCount","useField","yup","trim","required","value","errorMessage","handleBlur","minLength","min","computed","watch","val","setTimeout","values","dispatch","push","setup","route","query","message","error","__exports__","render"],"mappings":"qNAEI,eAAwB,UAApB,mBAAe,G,EAGjB,eAAgC,SAAzBA,IAAI,SAAQ,SAAK,G,YAMxB,eAAoC,SAA7BA,IAAI,YAAW,UAAM,G,mBAYzBC,MAAM,e,wEAtBb,eAyBO,QAzBDA,MAAM,OAAQ,SAAM,8CAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,e,CAC1C,EAEA,eAIM,OAJAD,MAAK,yBAA8B,EAAAE,U,CACvC,E,eACA,eAA+D,SAAxDC,KAAK,QAAQC,GAAG,Q,qDAAiB,EAAAC,MAAK,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAd,EAAAD,SAC3B,EAAAH,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGhC,eAIM,OAJAF,MAAK,yBAA8B,EAAAO,U,CACvC,E,eACA,eAAwE,SAAjEJ,KAAK,WAAWC,GAAG,W,qDAAoB,EAAAI,SAAQ,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAjB,EAAAD,YACjC,EAAAD,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGhC,eAMS,UALPP,MAAM,cACNG,KAAK,SACJO,SAAU,EAAAC,cAAgB,EAAAC,mBAC5B,UAED,gBAC+B,EAAAA,mB,iBAA/B,eAEM,MAFN,EAAkD,mE,kJCjB/C,SAASC,IACd,IAAMC,EAAQC,iBACRC,EAASC,iBAFc,EAGuBC,iBAA5CC,EAHqB,EAGrBA,aAAcR,EAHO,EAGPA,aAAcS,EAHP,EAGOA,YAHP,EAKqCC,eAChE,QACAC,SAEGC,OACAC,SAAS,4BACTnB,MAAM,uCANIA,EALc,EAKrBoB,MAA4BvB,EALP,EAKPwB,aAAkCpB,EAL3B,EAKeqB,WAStCC,EAAY,EAdW,EAgBwCP,eACnE,WACAC,SAEGC,OACAC,SAAS,6BACTK,IAAID,EAJP,sCAIiDA,EAJjD,eAFapB,EAhBc,EAgBrBiB,MAA+BlB,EAhBV,EAgBJmB,aAAkCjB,EAhB9B,EAgBkBkB,WASzCf,EAAoBkB,gBAAS,kBAAMV,EAAYK,OAAS,KAE9DM,eAAMnB,GAAmB,SAACoB,GACpBA,GACFC,YAAW,kBAAOb,EAAYK,MAAQ,IAAI,SAI9C,IAAMxB,EAAWkB,EAAY,yDAAC,WAAOe,GAAP,0GAEpBpB,EAAMqB,SAAS,aAAcD,GAFT,OAG1BlB,EAAOoB,KAAK,KAHc,0GAAD,uDAO7B,MAAO,CACL/B,QACAG,WACAN,SACAK,SACAD,QACAG,QACAR,WACAU,eACAC,qBDpBW,OACbyB,MADa,WAEX,IAAMC,EAAQ,iBACRxB,EAAQ,iBAQd,OANIwB,EAAMC,MAAMC,SACd1B,EAAMqB,SAAS,aAAc,CAC3BV,MAAO,OAAAgB,EAAA,MAAMH,EAAMC,MAAMC,SACzBrC,KAAM,YAGV,kBAAYU,O,qBEzChB,MAAM6B,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E","file":"js/chunk-2d0be70b.ad67877d.js","sourcesContent":["<template>\n  <form class=\"card\" @submit.prevent=\"onSubmit\">\n    <h1>Войти в систему</h1>\n\n    <div :class=\"['form-control', { invalid: eError }]\">\n      <label for=\"email\">Email</label>\n      <input type=\"email\" id=\"email\" v-model=\"email\" @blur=\"eBlur\" />\n      <small v-if=\"eError\">{{ eError }}</small>\n    </div>\n\n    <div :class=\"['form-control', { invalid: pError }]\">\n      <label for=\"password\">Пароль</label>\n      <input type=\"password\" id=\"password\" v-model=\"password\" @blur=\"pBlur\" />\n      <small v-if=\"pError\">{{ pError }}</small>\n    </div>\n\n    <button\n      class=\"btn primary\"\n      type=\"submit\"\n      :disabled=\"isSubmitting || isTooManyAttempts\"\n    >\n      Войти\n    </button>\n    <div class=\"text-danger\" v-if=\"isTooManyAttempts\">\n      Вы слишком часто пытаетесь войти в систему. Попробуйте позже\n    </div>\n  </form>\n</template>\n\n<script>\nimport { useRoute } from \"vue-router\";\nimport { useStore } from \"vuex\";\nimport { error } from \"../utils/error\";\nimport { useLoginForm } from \"../use/login-form\";\n\nexport default {\n  setup() {\n    const route = useRoute();\n    const store = useStore();\n\n    if (route.query.message) {\n      store.dispatch(\"setMessage\", {\n        value: error(route.query.message),\n        type: \"warning\",\n      });\n    }\n    return { ...useLoginForm() };\n  },\n};\n</script>\n\n<style scoped>\n</style>","import { useField, useForm } from 'vee-validate';\nimport * as yup from 'yup';\nimport { computed, watch } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\n\nexport function useLoginForm() {\n  const store = useStore();\n  const router = useRouter();\n  const { handleSubmit, isSubmitting, submitCount } = useForm();\n\n  const { value: email, errorMessage: eError, handleBlur: eBlur } = useField(\n    'email',\n    yup\n      .string()\n      .trim()\n      .required('Пожалуйста введите email')\n      .email('Необходимо ввести корректный email')\n  );\n\n  const minLength = 6;\n\n  const { value: password, errorMessage: pError, handleBlur: pBlur } = useField(\n    'password',\n    yup\n      .string()\n      .trim()\n      .required('Пожалуйста введите пароль')\n      .min(minLength, `Пароль не может быть меньше ${minLength} символов`)\n  );\n\n  const isTooManyAttempts = computed(() => submitCount.value >= 3);\n\n  watch(isTooManyAttempts, (val) => {\n    if (val) {\n      setTimeout(() => (submitCount.value = 0), 1500);\n    }\n  });\n\n  const onSubmit = handleSubmit(async (values) => {\n    try {\n      await store.dispatch('auth/login', values);\n      router.push('/');\n    } catch (e) {}\n  });\n\n  return {\n    email,\n    password,\n    eError,\n    pError,\n    eBlur,\n    pBlur,\n    onSubmit,\n    isSubmitting,\n    isTooManyAttempts,\n  };\n}\n","import { render } from \"./Auth.vue?vue&type=template&id=a3314d5c&scoped=true\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/sansaich/www/vue3-composition/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a3314d5c\"]])\n\nexport default __exports__"],"sourceRoot":""}